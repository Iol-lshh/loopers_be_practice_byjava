---
title: "요구사항 정의"
---

## 단어장

| 단어 | 영어 | 설명 |
| --- | --- | --- |
| 브랜드 | Brand | 상품을 판매하는 주체 |
| 상품 | Product | 브랜드가 판매하는 물건 |
| 좋아요 | Like | 상품에 대한 좋아요 표시 |
| 주문 | Order | 상품을 구매하는 행위 |
| 결제 | Payment | 주문을 완료하는 행위 |

## 브랜드 & 상품 (Brands / Products)

### 브랜드 조회

- 유스케이스
  - 일차 액터: 유저
  - 선조건: 유저는 브랜드를 특정할 수 있다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 브랜드 정보를 조회 한다.
  - 주요 성공 시나리오
    - 1.유저는 브랜드를 선택한다.
    - 2.클라이언트는 선택된 브랜드의 식별자로 서버에서 브랜드 정보를 조회한다.
    - 3.클라이언트는 브랜드 정보를 반환한다.
  - 확장
    - 2a.존재하지 않는 브랜드를 조회하면 NOT_FOUND 상태 코드를 반환한다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 브랜드 | 404 |

### 상품 목록 조회

- 유스케이스
  - 일차 액터: 유저
  - 선조건: 없음
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 상품 목록을 조회한다. 상품에 대한 좋아요 숫자가 같이 조회된다.
  - 주요 성공 시나리오
    - 1.유저는 상품 목록을 페이지를 요청한다.
    - 2.클라이언트는 페이지 요청에 따라 서버에서 상품 목록을 조회한다.
    - 3.클라이언트는 상품 목록을 반환한다.
    - 4.유저가 상품 목록 페이지에 있는 동안
    - 5.유저는 상품 목록을 최신순, 가격, 좋아요의 오름차순/내림차순 정렬을 선택할 수 있다.
    - 6.유저는 보이는 상품 목록의 갯수와 페이지를 선택할 수 있다.
    - 7.유저는 브랜드 필터링을 선택할 수 있다.
  - 확장
    - 3a.상품 목록이 없다면, 빈 목록을 반환한다.
    - 7a.브랜드가 조회되지 않는다면, NOT_FOUND 상태 코드를 반환한다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 브랜드 | 404 |

### 상품 정보 조회

- 유스케이스
  - 일차 액터: 유저
  - 선조건: 유저는 상품을 특정할 수 있다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 상품 정보를 조회한다. 상품에 대한 좋아요 숫자가 같이 조회된다.
  - 주요 성공 시나리오
    - 1.유저는 상품을 선택한다.
    - 2.클라이언트는 선택된 상품의 식별자로 서버에서 상품 정보를 조회한다.
    - 3.클라이언트는 상품 정보를 반환한다.
  - 확장
    - 2a.존재하지 않는 상품을 조회하면 NOT_FOUND 상태 코드를 반환한다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 상품 | 404 |

## 좋아요 (Likes)

### 상품 좋아요 등록

- 유스케이스
  - 일차 액터: 유저
  - 선조건: 
    - 유저는 로그인 상태다.
    - 유저는 상품을 특정할 수 있다.
    - 상품은 좋아요가 등록되지 않은 상태다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받으며, 상태가 바뀌지 않는다.
  - 성공 보증: 유저는 상품에 좋아요를 등록하면, 상품의 좋아요 수가 증가한다.
  - 주요 성공 시나리오
    - 1.유저는 상품에 좋아요를 누른다.
    - 2.클라이언트는 유저의 식별자와 상품의 식별자로 서버에 좋아요 등록 요청을 보낸다.
    - 3.서버는 유저가 존재하는지 확인한다.
    - 4.서버는 상품이 존재하는지 확인한다.
    - 5.서버는 상품에 좋아요가 등록되지 않은 상태인지 확인한다.
    - 6.서버는 상품에 좋아요를 등록한다.
    - 7.서버는 성공 상태를 반환한다.
    - 8.클라이언트는 상품에 좋아요를 등록하고, 상품의 좋아요 수를 증가시킨 것을 보여준다.
  - 확장
    - 1a.유저가 이미 좋아요를 누른 상태라면, <u>좋아요를 취소한다.</u>
    - 3a.유저가 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 4a.상품이 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 5a.이미 상품에 좋아요 등록이 되어있다면, CONFLICT 상태 코드를 반환한다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 유저 | 404 |
| 존재하지 않는 상품 | 404 |
| 이미 좋아요 등록된 상품 | 409 |

### 상품 좋아요 취소

- 유스케이스
  - 일차액터: 유저
  - 선조건:
    - 유저는 로그인 상태다.
    - 유저는 상품을 특정할 수 있다.
    - 상품은 좋아요가 등록된 상태다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받으며, 상태가 바뀌지 않는다.
  - 성공 보증: 유저는 상품에 좋아요를 취소하면, 상품의 좋아요 수가 감소한다.
  - 주요 성공 시나리오
    - 1.유저는 상품에 좋아요를 취소한다.
    - 2.클라이언트는 유저의 식별자와 상품의 식별자로 서버에 좋아요 취소 요청을 보낸다.
    - 3.서버는 유저가 존재하는지 확인한다.
    - 4.서버는 상품이 존재하는지 확인한다.
    - 5.서버는 상품이 좋아요가 등록된 상태인지 확인한다.
    - 6.서버는 상품에 등록된 좋아요를 취소한다.
    - 7.서버는 성공 상태를 반환한다.
    - 8.클라이언트는 상품에 좋아요를 취소하고, 상품의 좋아요 수를 감소시킨 것을 보여준다.
  - 확장
    - 1a.유저가 좋아요를 누르지 않은 상태라면, <u>좋아요를 등록한다.</u>
    - 3a.유저가 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 4a.상품이 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 5a.이미 상품에 좋아요 등록이 되어있지 않다면, CONFLICT 상태 코드를 반환한다.

- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 유저 | 404 |
| 존재하지 않는 상품 | 404 |
| 이미 좋아요 등록되지 않은 상품 | 409 |

### 내가 좋아요 한 상품 목록 조회

- 유스케이스
  - 일차액터: 유저
  - 선조건:
    - 유저는 로그인 상태다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 자신이 좋아요 한 상품 목록을 조회한다.
  - 주요 성공 시나리오
    - 1.유저는 좋아요 한 상품 목록 조회 페이지로 이동한다.
    - 2.클라이언트는 유저의 식별자로 서버에 좋아요 한 상품 목록을 조회 요청을 보낸다.
    - 3.서버는 유저가 존재하는지 확인한다.
    - 4.서버는 유저가 좋아요 한 상품 목록을 조회한다.
    - 5.서버는 좋아요 한 상품 목록을 반환한다.
    - 6.클라이언트는 좋아요 한 상품 목록을 유저에게 보여준다.
  - 확장
    - 2a.유저가 식별되지 않는다면, BAD_REQUEST 상태 코드를 반환한다.
    - 3a.유저가 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 4a.유저가 좋아요 한 상품 목록이 없다면, 빈 리스트를 반환한다.
    - 6a.유저가 좋아요 한 상품 목록이 없다면, 리스트가 비어있음을 보여준다.
- 비기능 요구사항
  - 사용자 인증은 `X-USER-ID` 헤더를 통해 이루어진다.
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 유저 | 404 |
| 잘못된 유저 식별자 헤더 | 400 |

## 주문 / 결제 (Orders/Payments)

### 주문 요청

- 유스케이스
  - 일차 액터: 유저
  - 선조건:
    - 유저는 로그인 상태다.
    - 유저는 주문을 위한 (상품, 갯수) 리스트를 가진 상태다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 주문을 요청하면, 주문이 성공한다.
  - 주요 성공 시나리오
    - 1.유저는 주문 리스트를 통해 주문을 요청한다.
    - 2.클라이언트는 유저의 식별자와 주문 요청 정보를 서버에 주문 요청을 보낸다.
    - 3.서버는 유저가 존재하는지 확인한다.
    - 4.서버는 주문의 상품 리스트를 조회한다.
    - 5.서버는 주문 정보를 저장한다.
    - 6.서버는 주문의 상품 리스트의 재고를 차감한다.
    - 7.서버는 유저의 포인트를 차감한다.
    - 8.서버는 외부 시스템에 필요한 처리를 요청한다.
    - 9.서버는 주문 생성 결과를 반환한다.
    - 10.클라이언트는 주문 생성 결과를 유저에게 보여준다.
  - 확장
    - 3a.유저가 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 4a.주문의 상품 리스트에 존재하지 않는 상품이 있다면, NOT_FOUND 상태 코드를 반환한다.
    - 6a.주문의 상품 리스트에 재고가 부족한 상품이 있다면, BAD_REQUEST 상태 코드를 반환한다.
    - 7a.유저가 주문을 지불 가능한 상태가 아니라면, BAD_REQUEST 상태 코드를 반환한다.
    - 8a.외부 시스템에 필요한 처리를 요청하는데 실패한다면,
      - 8a1.외부 시스템에 서킷브레이커를 적용하고, 대체 가능한 요청이 있는지 확인한다.
        - 8a1a.대체 가능한 요청이 없다면, INTERNAL_SERVER_ERROR 상태 코드를 반환한다.
      - 8a2.대체 가능한 요청이 있다면, 대체 가능한 요청을 실행한다.
        - 8a2a.대체한 요청도 실패한다면, INTERNAL_SERVER_ERROR 상태 코드를 반환한다.

- 비기능 요구사항
  - 포인트 사용에 대한 도메인 이벤트를 기록한다.
  - 외부 시스템에 주문 정보를 전송하는 것은 outbox 패턴을 사용한다.
  - 외부 시스템에 주문 정보를 전송하는 것은 서킷브레이커를 적용한다.
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 유저 | 404 |
| 존재하지 않는 상품 | 404 |
| 부족한 재고 | 400 |
| 부족한 포인트 | 400 |

### 유저의 주문 목록 조회

- 유스케이스
  - 일차 액터: 유저
  - 선조건:
    - 유저는 로그인 상태다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 자신의 주문 목록을 조회할 수 있다.
  - 주요 성공 시나리오
    - 1.유저는 주문 목록 조회 페이지로 이동한다.
    - 2.클라이언트는 유저의 식별자로 서버에 주문 목록 조회 요청을 보낸다.
    - 3.서버는 유저가 존재하는지 확인한다.
    - 4.서버는 유저의 주문 목록을 조회한다.
    - 5.서버는 주문 목록을 반환한다.
    - 6.클라이언트는 주문 목록을 유저에게 보여준다.
  - 확장
    - 2a.유저가 식별되지 않는 경우, BAD_REQUEST 상태 코드를 반환한다.
    - 3a.유저가 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 4a.유저가 주문 목록이 없다면, 빈 리스트를 반환한다.
    - 6a.유저가 주문 목록이 없다면, 리스트가 비어있음을 보여준다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.
  - 사용자 인증은 `X-USER-ID` 헤더를 통해 이루어진다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 유저 | 404 |
| 존재하지 않는 주문 | 404 |
| 잘못된 유저 식별자 헤더 | 400 |

### 단일 주문 상세 조회

- 유스케이스
  - 일차 액터: 유저
  - 선조건:
    - 유저는 로그인 상태다.
    - 유저는 주문을 특정할 수 있다.
  - 최소 보증: 클라이언트는 실패 상태 메시지를 받는다.
  - 성공 보증: 유저는 주문 상세 정보를 조회할 수 있다.
  - 주요 성공 시나리오
    - 1.유저는 주문을 선택한다.
    - 2.클라이언트는 선택된 주문의 식별자로 서버에 주문 상세 정보 조회 요청을 보낸다.
    - 3.서버는 주문이 존재하는지 확인한다.
    - 4.서버는 주문 상세 정보를 조회한다.
    - 5.주문 상세 정보의 유저 식별자가 일치하면, 주문 상세 정보를 반환한다.
    - 6.클라이언트는 주문 상세 정보를 유저에게 보여준다.
  - 확장
    - 2a.유저 식별자가 없는 경우, BAD_REQUEST 상태 코드를 반환한다.
    - 3a.주문이 존재하지 않는다면, NOT_FOUND 상태 코드를 반환한다.
    - 5a.주문 상세 정보의 유저 식별자가 일치하지 않는다면, BAD_REQUEST 상태 코드를 반환한다.
- 비기능 요구사항
  - 오류에 다음과 같은 HTTP 상태 코드를 반환한다.

| 케이스 | 상태 코드 |
| --- | --- |
| 존재하지 않는 주문 | 404 |
